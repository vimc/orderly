<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Clean up orderly draft and data directories.  Deletes all drafts
(possibly just for a set of report names) and then deletes
dangling data sets that are not pointed to by any draft or
committed reports.  Running cleanup does not affect any reports
that have been committed with orderly_commit() (i.e.,
the contents of the archive/ directory)."><title>Orderly cleanup — orderly_cleanup • orderly</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Orderly cleanup — orderly_cleanup"><meta property="og:description" content="Clean up orderly draft and data directories.  Deletes all drafts
(possibly just for a set of report names) and then deletes
dangling data sets that are not pointed to by any draft or
committed reports.  Running cleanup does not affect any reports
that have been committed with orderly_commit() (i.e.,
the contents of the archive/ directory)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">orderly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/orderly.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bundles.html">orderly bundles</a>
    <a class="dropdown-item" href="../articles/changelog.html">orderly changelog</a>
    <a class="dropdown-item" href="../articles/patterns.html">orderly patterns</a>
    <a class="dropdown-item" href="../articles/remote.html">orderly remotes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vimc/orderly/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Orderly cleanup</h1>
      <small class="dont-index">Source: <a href="https://github.com/vimc/orderly/blob/HEAD/R/cleanup.R" class="external-link"><code>R/cleanup.R</code></a></small>
      <div class="d-none name"><code>orderly_cleanup.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Clean up orderly draft and data directories.  Deletes all drafts
(possibly just for a set of report names) and then deletes
dangling data sets that are not pointed to by any draft or
committed reports.  Running cleanup does not affect any reports
that have been committed with <code><a href="orderly_commit.html">orderly_commit()</a></code> (i.e.,
the contents of the <code>archive/</code> directory).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orderly_cleanup</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  root <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  locate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  draft <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  failed_only <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>name</dt>
<dd><p>Optional name; in this case only clean up drafts with this name</p></dd>


<dt>root</dt>
<dd><p>The path to an orderly root directory, or <code>NULL</code>
(the default) to search for one from the current working
directory if <code>locate</code> is <code>TRUE</code>.</p></dd>


<dt>locate</dt>
<dd><p>Logical, indicating if the configuration should be
searched for.  If <code>TRUE</code> and <code>config</code> is not given,
then orderly looks in the working directory and up through its
parents until it finds an <code>orderly_config.yml</code> file.</p></dd>


<dt>draft</dt>
<dd><p>Logical, indicating if drafts should be removed</p></dd>


<dt>data</dt>
<dd><p>Logical, indicating if dangling data should be removed
(data not used by any draft or archived report).</p></dd>


<dt>failed_only</dt>
<dd><p>Delete only failed reports (those without the
end-of-run metadata).  This will also clean up drafts created by
<code><a href="orderly_test_start.html">orderly_test_start()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>No return value, this function is called only for its side effects</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># In a new example orderly, run two reports and commit only the</span></span></span>
<span class="r-in"><span><span class="co"># second one:</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_example.html">orderly_example</a></span><span class="op">(</span><span class="st">"minimal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">id1</span> <span class="op">&lt;-</span> <span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_run.html">orderly_run</a></span><span class="op">(</span><span class="st">"example"</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">name      </span> ]  example</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">id        </span> ]  20230621-105025-7725293e</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">start     </span> ]  2023-06-21 10:50:25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">data      </span> ]  source =&gt; dat: 20 x 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; png("mygraph.png")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; par(mar = c(15, 4, 0.5, 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; barplot(setNames(dat$number, dat$name), las = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; dev.off()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_png </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">end       </span> ]  2023-06-21 10:50:25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">elapsed   </span> ]  Ran report in 0.01623964 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">artefact  </span> ]  mygraph.png: 175369b2bcf4115f343c8ad746c0c072</span>
<span class="r-in"><span><span class="va">id2</span> <span class="op">&lt;-</span> <span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_run.html">orderly_run</a></span><span class="op">(</span><span class="st">"example"</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">name      </span> ]  example</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">id        </span> ]  20230621-105025-83ad7397</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">start     </span> ]  2023-06-21 10:50:25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">data      </span> ]  source =&gt; dat: 20 x 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; png("mygraph.png")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; par(mar = c(15, 4, 0.5, 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; barplot(setNames(dat$number, dat$name), las = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; dev.off()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_png </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">end       </span> ]  2023-06-21 10:50:25</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">elapsed   </span> ]  Ran report in 0.01527786 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">artefact  </span> ]  mygraph.png: 175369b2bcf4115f343c8ad746c0c072</span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_commit.html">orderly_commit</a></span><span class="op">(</span><span class="va">id2</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">commit    </span> ]  example/20230621-105025-83ad7397</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">copy      </span> ]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">import    </span> ]  example:20230621-105025-83ad7397</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">success   </span> ]  :)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/RtmpGRuIRx/file476afa7968/archive/example/20230621-105025-83ad7397"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We now have one draft and one archive report:</span></span></span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_list_drafts.html">orderly_list_drafts</a></span><span class="op">(</span>root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      name                       id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 example 20230621-105025-7725293e</span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_list_drafts.html">orderly_list_archive</a></span><span class="op">(</span>root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      name                       id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 example 20230621-105025-83ad7397</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To clean up the drafts:</span></span></span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu">orderly_cleanup</span><span class="op">(</span>root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">clean     </span> ]  Found 1 draft report</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">clean     </span> ]  /tmp/RtmpGRuIRx/file476afa7968/draft/example/20230621-105025-7725293e</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">clean     </span> ]  Found 0 csv files</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">clean     </span> ]  Found 0 rds files</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We now have no draft and one archive reports:</span></span></span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_list_drafts.html">orderly_list_drafts</a></span><span class="op">(</span>root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] name id  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;0 rows&gt; (or 0-length row.names)</span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_list_drafts.html">orderly_list_archive</a></span><span class="op">(</span>root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      name                       id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 example 20230621-105025-83ad7397</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rich FitzJohn, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, James Thompson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

