<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Run a report.  This will create a new directory in
drafts/&amp;lt;reportname&amp;gt;, copy your declared resources there,
extract data from databases (if you are using them), run your
script and check that all expected artefacts were created.  Once
successfully run you can use orderly_commit() to move
it to the archive directory."><title>Run a report — orderly_run • orderly</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run a report — orderly_run"><meta property="og:description" content="Run a report.  This will create a new directory in
drafts/&amp;lt;reportname&amp;gt;, copy your declared resources there,
extract data from databases (if you are using them), run your
script and check that all expected artefacts were created.  Once
successfully run you can use orderly_commit() to move
it to the archive directory."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">orderly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/orderly.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bundles.html">orderly bundles</a>
    <a class="dropdown-item" href="../articles/changelog.html">orderly changelog</a>
    <a class="dropdown-item" href="../articles/patterns.html">orderly patterns</a>
    <a class="dropdown-item" href="../articles/remote.html">orderly remotes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vimc/orderly/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run a report</h1>
      <small class="dont-index">Source: <a href="https://github.com/vimc/orderly/blob/HEAD/R/recipe_run.R" class="external-link"><code>R/recipe_run.R</code></a></small>
      <div class="d-none name"><code>orderly_run.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run a report.  This will create a new directory in
<code>drafts/&lt;reportname&gt;</code>, copy your declared resources there,
extract data from databases (if you are using them), run your
script and check that all expected artefacts were created.  Once
successfully run you can use <code><a href="orderly_commit.html">orderly_commit()</a></code> to move
it to the <code>archive</code> directory.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">orderly_run</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parameters <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  envir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  root <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  locate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  echo <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  message <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  instance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_draft <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  remote <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tags <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>name</dt>
<dd><p>Name of the report to run (see
<code><a href="orderly_list.html">orderly_list()</a></code>).  A leading <code>src/</code> will be
removed if provided, allowing easier use of autocomplete.
Alternatively, the default of <code>NULL</code> is useful if you have
already set the working directory to be the source directory.</p></dd>


<dt>parameters</dt>
<dd><p>Parameters passed to the report. A named list of
parameters declared in the <code>orderly.yml</code>.  Each parameter
must be a scalar character, numeric, integer or logical.</p></dd>


<dt>envir</dt>
<dd><p>The parent of the environment that will be used to
evaluate the report script; by default a new environment will be
made with the global environment as the parent.</p></dd>


<dt>root</dt>
<dd><p>The path to an orderly root directory, or <code>NULL</code>
(the default) to search for one from the current working
directory if <code>locate</code> is <code>TRUE</code>.</p></dd>


<dt>locate</dt>
<dd><p>Logical, indicating if the configuration should be
searched for.  If <code>TRUE</code> and <code>config</code> is not given,
then orderly looks in the working directory and up through its
parents until it finds an <code>orderly_config.yml</code> file.</p></dd>


<dt>echo</dt>
<dd><p>Print the result of running the R code to the console</p></dd>


<dt>message</dt>
<dd><p>An optional character string containing a message
explaining why the report was run</p></dd>


<dt>instance</dt>
<dd><p>Select instance of the source database to be used,
where multiple instances are configured.  Use a single
<em>unnamed</em> character string to indicate an instance to
match.  If given, then this name must be present in all
databases where instances are listed in
<code>orderly_config.yml</code>, and will be ignored by all database
where instances are not given.  See the "orderly" vignette for
further information.</p></dd>


<dt>use_draft</dt>
<dd><p>Should draft reports be used for dependencies?
This should be used only in development.  Valid values are
logical (<code>TRUE</code>, <code>FALSE</code>) or use the string
<code>newer</code> to use draft reports where they are newer than
archive reports.  For consistency, <code>always</code> and
<code>never</code> are equivalent to <code>TRUE</code> and <code>FALSE</code>,
respectively.</p></dd>


<dt>remote</dt>
<dd><p>Remote to use to resolve dependencies.  Use this in
order to run a report with the same dependencies as are
available on a remote server, particularly when using <code>id = "latest"</code>.  Note that this is not the same as running
<code><a href="orderly_pull_dependencies.html">orderly_pull_dependencies()</a></code>, then <code>orderly_run</code>
with <code>remote = NULL</code>, as the pull/run approach will use the
latest report in <em>your</em> archive but the <code>remote = "remote"</code> approach will use the latest approach in the
<em>remote</em> archive (which might be less recent).</p></dd>


<dt>tags</dt>
<dd><p>Character vector of tags to add to the report.  Tags
are immutable and cannot be removed once the report is run.
Tags added here will be <em>in addition</em> to any tags listed in
the <code>tags:</code> field in <code>orderly.yml</code> and must be present
in <code>orderly_config.yml</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The id of the newly created report</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Parameters are passed to the report as a named list, for example</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1"></a>id &lt;-<span class="st"> </span>orderly<span class="op">::</span><span class="kw">orderly_run</span>(<span class="st">"other"</span>, <span class="kw">list</span>(<span class="dt">nmin =</span> <span class="fl">0.2</span>), <span class="dt">root =</span> path)</span></code></pre><p></p></div>
<p>(see the examples).  The names of the parameters (here,
<code>nmin</code>) must correspond to declared parameters in the
<code>orderly.yml</code>.  It is an error if parameters without a
default are omitted, and it is an error if unknown parameters are
provided.</p>
<p>Environment variables that are created in <code>orderly_envir.yml</code>
will be available while the report runs.  Those that begin with
<code>ORDERLY_</code> will be saved into the <code>orderly_run.rds</code>
within the <code>$env</code> section (except for any that match the
patterns "TOKEN", "PAT" or "PASS").</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="orderly_log.html">orderly_log()</a></code> for controlling display of log
messages (not just R output)</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_example.html">orderly_example</a></span><span class="op">(</span><span class="st">"demo"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To run most reports, provide the report name (and the path if</span></span></span>
<span class="r-in"><span><span class="co"># not running in the working directory, as is the case here):</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu">orderly</span><span class="fu">::</span><span class="fu">orderly_run</span><span class="op">(</span><span class="st">"minimal"</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">name      </span> ]  minimal</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">id        </span> ]  20230621-105037-a888d8b4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">start     </span> ]  2023-06-21 10:50:37</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">data      </span> ]  source =&gt; dat: 20 x 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; png("mygraph.png")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; par(mar = c(15, 4, 0.5, 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; barplot(setNames(dat$number, dat$name), las = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; dev.off()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_png </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">end       </span> ]  2023-06-21 10:50:37</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">elapsed   </span> ]  Ran report in 0.01624155 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">artefact  </span> ]  mygraph.png: 175369b2bcf4115f343c8ad746c0c072</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Every report gets a unique identifier, based on the time (it is</span></span></span>
<span class="r-in"><span><span class="co"># ISO 8601 time with random hex appended to end)</span></span></span>
<span class="r-in"><span><span class="va">id</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "20230621-105037-a888d8b4"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># After being run, a report is a "draft" and will exist in the</span></span></span>
<span class="r-in"><span><span class="co"># drafts directory:</span></span></span>
<span class="r-in"><span><span class="fu">orderly</span><span class="fu">::</span><span class="fu"><a href="orderly_list_drafts.html">orderly_list_drafts</a></span><span class="op">(</span>root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      name                       id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 minimal 20230621-105037-a888d8b4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Draft reports are always stored in the path</span></span></span>
<span class="r-in"><span><span class="co"># &lt;root&gt;/draft/&lt;name&gt;/&lt;id&gt;, so we have</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="st">"draft"</span>, <span class="st">"minimal"</span>, <span class="va">id</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mygraph.png"     "orderly.yml"     "orderly_run.rds" "script.R"       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># which contains the files when the report was run.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If a report has parameters, then these must be passed in as a</span></span></span>
<span class="r-in"><span><span class="co"># named list.</span></span></span>
<span class="r-in"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu">orderly</span><span class="fu">::</span><span class="fu">orderly_run</span><span class="op">(</span><span class="st">"other"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nmin <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, root <span class="op">=</span> <span class="va">path</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">name      </span> ]  other</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">id        </span> ]  20230621-105037-b6d52021</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">sources   </span> ]  functions.R</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">parameter </span> ]  nmin: 0.2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">start     </span> ]  2023-06-21 10:50:37</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">data      </span> ]  source =&gt; extract: 19 x 2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">parameter </span> ]  nmin: 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; extract$number &lt;- extract$number + rnorm(1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; write.csv(extract, "summary.csv", row.names = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; png("graph.png")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; par(mar = c(15, 4, 0.5, 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; do_plot(extract)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &gt; dev.off()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agg_png </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">end       </span> ]  2023-06-21 10:50:37</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">elapsed   </span> ]  Ran report in 0.01738548 secs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">artefact  </span> ]  summary.csv: 08a4566d063098080bfd318f675926f2</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [ <span style="color: #555555; font-weight: bold;">...       </span> ]  graph.png: 9d98e56ce7726a1523c1b03eb0e4efb4</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># These parameters can be used in SQL queries or in the report</span></span></span>
<span class="r-in"><span><span class="co"># code.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rich FitzJohn, Robert Ashton, Alex Hill, Martin Eden, Wes Hinsley, Emma Russell, James Thompson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

